<html><head><title>Guerrilla Mail API</title><style type="text/css">ol{margin:0;padding:0}p{margin:0}.c1{line-height:1.15;padding-top:11.0pt;text-indent:36.0pt;direction:ltr;margin-left:36.0pt;margin:0;padding-bottom:2.0pt}.c21{color:#000099;font-size:8pt;font-family:Courier New;text-decoration:underline}.c10{color:#000099;font-size:8pt;font-family:Arial;text-decoration:underline}.c18{color:#000099;font-size:11pt;font-family:Arial;text-decoration:underline}.c5{text-indent:72.0pt;height:11pt;margin-left:72.0pt}.c27{color:#000000;font-size:10pt;font-family:Courier New}.c20{padding-top:24.0pt;margin:0;padding-bottom:6.0pt}.c23{color:#000000;font-size:8pt;font-family:Arial}.c9{list-style-type:circle;margin:0;padding:0}.c16{padding-top:14.0pt;margin:0;padding-bottom:4.0pt}.c14{padding-top:11.0pt;margin:0;padding-bottom:2.0pt}.c0{color:#000000;font-size:11pt;font-family:Arial}.c19{color:#000000;font-size:14pt;font-family:Arial}.c15{width:468.0pt;background-color:#ffffff;padding:72.0pt 72.0pt 72.0pt 72.0pt}.c7{color:#000000;font-size:8pt;font-family:Courier New}.c26{color:#000000;font-size:24pt;font-family:Arial}.c25{list-style-type:square;margin:0;padding:0}.c3{padding-left:0pt;margin-left:72.0pt}.c4{font-style:italic;text-decoration:underline}.c22{padding-left:0pt;margin-left:108.0pt}.c6{text-indent:72.0pt;margin-left:72.0pt}.c2{line-height:1.15;direction:ltr}.c11{text-indent:36.0pt;margin-left:36.0pt}.c24{text-indent:72.0pt;margin-left:36.0pt}.c12{text-indent:108.0pt;margin-left:72.0pt}.c8{height:11pt}.c13{font-weight:bold}.c17{font-style:italic}body{color:#000000;font-size:11pt;font-family:Arial}h1{color:#000000;font-size:24pt;margin:0;font-family:Arial;font-weight:bold;padding:0}h2{color:#000000;font-size:18pt;margin:0;font-family:Arial;font-weight:bold;padding:0}h3{color:#000000;font-size:14pt;margin:0;font-family:Arial;font-weight:bold;padding:0}h4{color:#000000;font-size:12pt;margin:0;font-family:Arial;font-weight:bold;padding:0}h5{color:#000000;font-size:11pt;margin:0;font-family:Arial;font-weight:bold;padding:0}h6{color:#000000;font-size:10pt;margin:0;font-family:Arial;font-weight:bold;padding:0}</style></head><body class="c15"><h1 class="c2 c20"><a name="h.1b1hptbc0bcs"></a><span class="c13 c26">Guerrilla Mail JSON API</span></h1><p class="c2"><span class="c23">version 1.0, 19th Apr 2011 </span></p><p class="c2 c8"><span class="c23"></span></p><p class="c2"><span class="c23">The latest version of this document is available on Google Docs here: </span><span class="c10"><a href="https://docs.google.com/document/d/1Qw5KQP1j57BPTDmms5nspe-QAjNEsNg8cQHpAAycYNM/edit?hl=en">https://docs.google.com/document/d/1Qw5KQP1j57BPTDmms5nspe-QAjNEsNg8cQHpAAycYNM/edit?hl=en</a></span></p><h3 class="c16 c2"><a name="h.19x98lpy605k"></a><span class="c19 c13">Introduction</span></h3><p class="c2 c8"><span class="c0"></span></p><p class="c2"><span class="c0">Guerrilla Mail provides a JSON API through HTTP. The API is public and open to all.</span></p><p class="c2 c8"><span class="c0"></span></p><p class="c2"><span class="c0">The API URL is located at: </span><span class="c18 c13"><a href="http://api.guerrillamail.com/ajax.php">http://api.guerrillamail.com/ajax.php</a></span></p><p class="c2 c8"><span class="c0 c13"></span></p><p class="c2 c11"><span class="c0 c13">Each request to the above URL must have a parameter &lsquo;f&rsquo;, indicating the function name. It should also pass &lsquo;ip&rsquo; and &lsquo;agent&rsquo; to indicate the IP address and user-agent of the user-end. Followed by the argument(s) as required by the function specification. The result will be returned in a JSON encoded string. </span></p><p class="c2 c5"><span class="c0"></span></p><p class="c6 c2"><span class="c0">Example: &nbsp;http://api.guerrillamail.com/ajax.php?f=get_email_address&amp;ip=127.0.0.1&amp;agent=Mozilla_foo_bar</span></p><p class="c2 c8"><span class="c0"></span></p><p class="c2"><span class="c0">As a requirement, the client interacting with the API must be able to save, send and receive the following cookies</span></p><p class="c2 c8"><span class="c0"></span></p><p class="c2"><span class="c0">SUBSCR - A subscriber cookie. Set by the server if the email address has an active subscription. The client must save this value if changed, but does not need to send as a cookie at each request. (The value is later used as a parameter to a function call)</span></p><p class="c2 c8"><span class="c0"></span></p><p class="c2"><span class="c0">PHPSESSID - A session ID. Set by the server for each client to maintain state. The client must always look for this cookie in the HTTP header, remember it (if changed), and then provide it as cookie data in each HTTP request. This value can change at every call, and when it changes, it indicates that a new session was started; the client would need to re-fresh the interace with new data.</span></p><p class="c2 c8"><span class="c0"></span></p><p class="c2"><span class="c0">Note: The API may be rate limited, but we do not publish our rate limits. Please use this API carefully.</span></p><p class="c2 c8"><span class="c0"></span></p><p class="c2"><span class="c19">Created a guerrilla mail app? Let us know </span><span class="c19 c13">support@guerrillamail.com</span></p><h3 class="c16 c2"><a name="h.4z8k7wrwxhd"></a><span class="c19 c13">Flow</span></h3><p class="c2 c8"><span class="c0"></span></p><p class="c2"><span class="c0">1. User accesses the Guerrilla Mail Application, an email address is given. App initialization, the mail box is loaded. (Call to </span><span class="c0 c4">get_email_address</span><span class="c0"> is made, the client can get the session id, email address and email address&rsquo; timestamp)</span></p><p class="c2 c8"><span class="c0"></span></p><p class="c2"><span class="c0">2. Check for new email, this could be a function that works in the background (A call to </span><span class="c0 c4">check_email</span><span class="c0"> is made)</span></p><p class="c2 c8"><span class="c0"></span></p><p class="c2"><span class="c0">3. New email arrives, the user clicks on it. Email is fetched and displayed (A call to </span><span class="c0 c4">fetch_email</span><span class="c0"> is made)</span></p><p class="c2 c8"><span class="c0"></span></p><p class="c2"><span class="c0">4. To change the email address - the user can set the email address. &nbsp;(A call to </span><span class="c0 c4">set_email_user</span><span class="c0"> is made). After making a call to this function, the client can fetch the email list for this email by checking the email. Note: When a user changes the email address from one address to another, the old email address and its emails are NOT deleted, if the user changes back to the old address then their messages will still be there until the address expires or the message is 1 hour old.</span></p><p class="c2 c8"><span class="c0"></span></p><p class="c2"><span class="c0">5. Forget email - tell the server forget the current email address (but do not delete it) (A call to </span><span class="c0 c4">forget_me</span><span class="c0"> is made)</span></p><p class="c2 c8"><span class="c0"></span></p><p class="c2"><span class="c0">6. Extend time - Tell the server extend time for the current address (A call to </span><span class="c0 c4">extend </span><span class="c0">is made)</span></p><p class="c2 c8"><span class="c0"></span></p><p class="c2"><span class="c0">7. Email expired - The client should keep time of when the email expires. Some calls also return a timestamp. The timestamp is a Unix timestamp, indicating when the address was created. The client can calculate how many minutes are remaining:</span></p><p class="c2 c8"><span class="c0"></span></p><p class="c2 c11"><span class="c27">seconds remaining = 3600 - Current Timestamp - Email Timestamp</span></p><p class="c2 c8"><span class="c0"></span></p><p class="c2 c8"><span class="c0"></span></p><p class="c2"><span class="c0">Note: A session can expire after about 18 minutes of inactivity. If a session expires, a new email address will be generated when making a call to </span><span class="c0 c4">get_email_address</span><span class="c0"> , a user can always return to the old email address by making a call to </span><span class="c0 c4">set_email_user</span></p><p class="c2 c8"><span class="c0"></span></p><h3 class="c2 c16"><a name="h.x2777oamu1pa"></a><span class="c19 c13">Functions</span></h3><p class="c2"><span class="c0">Each HTTP request to </span><span class="c18"><a href="http://api.guerrillamail.com/ajax.php">http://api.guerrillamail.com/ajax.php</a></span><span class="c0"> is considered a function call. The client could use GET when querying for data, and POST when setting or deleting data, although this is not strictly enforced. Each request must contain the &lsquo;f&rsquo; parameter containing the function name, the &lsquo;ip&rsquo; parameter of the end user, and the &lsquo;agent&rsquo; parameter of the end user&rsquo;s user agent.</span></p><h5 class="c14 c2"><a name="h.fgwiz1d6jxqa"></a><span class="c0 c13">Function</span></h5><p class="c2"><span class="c0 c4">get_email_address</span></p><p class="c2 c8"><span class="c0"></span></p><h5 class="c1"><a name="h.94upqofc9br"></a><span class="c0 c13">Arguments</span></h5><p class="c2 c11 c8"><span class="c0"></span></p><ol class="c9" start="1"><li class="c3 c2"><span class="c0">&lsquo;lang&rsquo; - a string representing the language code. Currently supported: en, fr, nl, ru, tr, uk, ar, ko, jp, zh, zh-hant</span></li></ol><p class="c5 c2"><span class="c0"></span></p><ol class="c9" start="1"><li class="c3 c2"><span class="c0">&lsquo;SUBSCR&rsquo; - the subscriber cookie data, given to the client in a previous session</span></li></ol><p class="c2 c11 c8"><span class="c0"></span></p><h5 class="c1"><a name="h.r6azkrjwasr8"></a><span class="c0 c13">Description</span></h5><p class="c2 c11 c8"><span class="c0"></span></p><p class="c6 c2"><span class="c0">The function is used to initialize a session and set the client with an email address. If the session already exists, then it will return the email address details of the existing session. If a new session needs to be created, then it will first check for the SUBSCR cookie to create a session for a subscribed address, otherwise it will create new email address randomly.</span></p><p class="c5 c2"><span class="c0"></span></p><p class="c6 c2"><span class="c0">The session is maintained using HTTP Cookies. The cookie name is &lsquo;PHPSESSID&rsquo;, and it will be given in the resulting HTTP header. The client should always store this cookie and send it whenever making an API call. A new session will be created when the &lsquo;PHPSESSID&rsquo; cookie is not given by the client. The function also generates a new welcome email for the user.</span></p><p class="c5 c2"><span class="c0"></span></p><p class="c6 c2"><span class="c0">To send &lsquo;PHPSESSID&rsquo; in a HTTP request, add the following line to the header:</span></p><p class="c5 c2"><span class="c0"></span></p><p class="c6 c2"><span class="c0">Cookie: PHPSESSID=ABC1234\r\n&quot;;</span></p><p class="c5 c2"><span class="c0"></span></p><p class="c6 c2"><span class="c0">Where &lsquo;ABC1234&rsquo; is the data for the &lsquo;PHPSESSID&rsquo; cookie.</span></p><p class="c5 c2"><span class="c0"></span></p><p class="c6 c2"><span class="c0">The client should always watch the &lsquo;PHPSESSID&rsquo; cookie for changes. If it changes, it needs to update this value, and pass it in subsequent calls.</span></p><p class="c2 c8"><span class="c0"></span></p><p class="c2 c8 c11"><span class="c0"></span></p><h5 class="c1"><a name="h.nm8y36qhw283"></a><span class="c0 c13">Returns</span></h5><p class="c2 c11 c8"><span class="c0"></span></p><p class="c6 c2"><span class="c0">An object with the following properties:</span></p><p class="c5 c2"><span class="c0"></span></p><ol class="c9" start="1"><li class="c3 c2"><span class="c0">&lsquo;email_addr&rsquo; - The email address that that was determined. If a previous session was found, then it will be the email address of that session. If the SUBSCR cookie was matched, it will be the email in the cookie, otherwise a new random email address will be created.</span></li></ol><p class="c5 c2"><span class="c0"></span></p><ol class="c9" start="1"><li class="c3 c2"><span class="c0">&lsquo;email_timestamp&rsquo; - a UNIX timestamp when the email address was created. Used by the client to keep track of expiry.</span></li></ol><p class="c5 c2"><span class="c0"></span></p><ol class="c9" start="1"><li class="c3 c2"><span class="c0">&lsquo;s_active&rsquo; - Subscription active, Y or N</span></li><li class="c3 c2"><span class="c0">&lsquo;s_date&rsquo; - The full date of the subscription</span></li><li class="c3 c2"><span class="c0">&lsquo;s_time&rsquo; - The UNIX timestamp of subscription</span></li><li class="c3 c2"><span class="c0">&lsquo;s_time_expires&rsquo; - The UNIX timestamp for when the subscription expires</span></li></ol><p class="c2 c8"><span class="c0 c13"></span></p><p class="c2 c11"><span class="c0">Note that the server could set a new SUBSCR cookie, also it may return with a new PHPSESSID cookie which you would need to update and store in your client.</span></p><h5 class="c2 c14"><a name="h.kabxsxqbstg4"></a><span class="c0 c13">Function</span></h5><p class="c2 c8"><span class="c0"></span></p><p class="c2"><span class="c0 c4">set_email_user</span></p><p class="c2 c8"><span class="c0"></span></p><h5 class="c1"><a name="h.948ciscjc2xn"></a><span class="c0 c13">Arguments</span></h5><p class="c2 c8"><span class="c0"></span></p><ol class="c9" start="1"><li class="c3 c2"><span class="c0">&lsquo;email_user&rsquo; - String. The username part of an email address. example: test@guerrillamailblock.com, the email_user part would be &lsquo;test&rsquo;</span></li></ol><p class="c2 c8"><span class="c0"></span></p><ol class="c9" start="1"><li class="c3 c2"><span class="c0">&lsquo;lang&rsquo; - String. The language code, eg. &lsquo;en&rsquo;</span></li></ol><p class="c5 c2"><span class="c0"></span></p><p class="c6 c2"><span class="c0">Note: PHPSESSID must be passed as a cookie</span></p><p class="c2 c8"><span class="c0"></span></p><h5 class="c1"><a name="h.c36xpf5cq3fx"></a><span class="c0 c13">Description</span></h5><p class="c2 c8"><span class="c0"></span></p><p class="c6 c2"><span class="c0">Set the email address to a different email address. If the email address is a subscriber, then return the subscription details. If the email is not a subscriber, then the email address will be given 60 minutes again. A new email address will be generated if the email address is not in the database and a welcome email message will be generated.</span></p><p class="c2 c8"><span class="c0"></span></p><h5 class="c1"><a name="h.wmql474rxwfx"></a><span class="c0 c13">Returns</span></h5><p class="c2 c8"><span class="c0"></span></p><p class="c2 c6"><span class="c0">Similar to get_email_address, this function returns an object with the following properties:</span></p><p class="c5 c2"><span class="c0"></span></p><ol class="c9" start="1"><li class="c3 c2"><span class="c0">&lsquo;email_addr&rsquo; - The email address that that was determined. If a previous session was found, then it will be the email address of that session. If the SUBSCR cookie was matched, it will be the email in the cookie, otherwise a new random email address will be created. Eg, test@guerrillamailblock.com</span></li></ol><p class="c5 c2"><span class="c0"></span></p><ol class="c9" start="1"><li class="c3 c2"><span class="c0">&lsquo;email_timestamp&rsquo; - a UNIX timestamp when the email address was created. Used by the client to keep track of expiry.</span></li></ol><p class="c5 c2"><span class="c0"></span></p><ol class="c9" start="1"><li class="c3 c2"><span class="c0">&lsquo;s_active&rsquo; - Subscription active, Y or N</span></li><li class="c3 c2"><span class="c0">&lsquo;s_date&rsquo; - The full date of the subscription</span></li><li class="c3 c2"><span class="c0">&lsquo;s_time&rsquo; - The UNIX timestamp of subscription</span></li><li class="c3 c2"><span class="c0">&lsquo;s_time_expires&rsquo; - The UNIX timestamp for when the subscription expires</span></li></ol><p class="c2 c8"><span class="c0"></span></p><h5 class="c14 c2"><a name="h.6iwce51cltkp"></a><span class="c0 c13">Function</span></h5><p class="c2"><span class="c0 c4">check_email</span></p><p class="c2 c8"><span class="c0"></span></p><h5 class="c1"><a name="h.hznq363kpgd7"></a><span class="c0 c13">Arguments</span></h5><p class="c2 c8"><span class="c0"></span></p><ol class="c9" start="1"><li class="c3 c2"><span class="c0">seq - The sequence number (id) of the oldest email</span></li></ol><h5 class="c1"><a name="h.j1m4do345zh5"></a><span class="c0 c13">Description</span></h5><p class="c2 c11 c8"><span class="c0"></span></p><p class="c6 c2"><span class="c0">Check for new email on the server. Returns a list of the newest messages. The maximum size of the list is 20 items.</span></p><p class="c5 c2"><span class="c0"></span></p><p class="c6 c2"><span class="c0">The client should not check email too many times as to not overload the server. Do not check if the email expired, the email checking routing should pause if the email expired.</span></p><p class="c2 c8"><span class="c0"></span></p><h5 class="c1"><a name="h.kcb86ywdkca8"></a><span class="c0 c13">Returns</span></h5><p class="c2 c8"><span class="c0"></span></p><p class="c2 c24"><span class="c0">An an object with the following properties:</span></p><p class="c5 c2"><span class="c0"></span></p><ol class="c9" start="1"><li class="c3 c2"><span class="c0">&lsquo;list&rsquo; - A list of messages, represented as an array of objects. Each object has the following properties: <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lsquo;mail_id&rsquo;, </span></li></ol><p class="c2 c12"><span class="c0">&lsquo;mail_from&rsquo; (email address of sender), </span></p><p class="c2 c12"><span class="c0">&lsquo;mail_subject&rsquo;, </span></p><p class="c2 c12"><span class="c0">&lsquo;mail_excerpt&rsquo; (snippet from the email), </span></p><p class="c2 c12"><span class="c0">&lsquo;mail_timestamp&rsquo; (a UNIX timestamp), </span></p><p class="c2 c12"><span class="c0">&lsquo;mail_read&rsquo; (1 if read, 0 if not), &lsquo;mail_date&rsquo;</span></p><p class="c2 c12 c8"><span class="c0"></span></p><p class="c2 c12"><span class="c0 c17">Note: &lsquo;mail_subject&rsquo; and &lsquo;mail_excerpt&rsquo; are escaped using HTML Entities.</span></p><p class="c2 c12 c8"><span class="c0"></span></p><ol class="c9" start="1"><li class="c2 c3"><span class="c0">&lsquo;count&rsquo; - The number of emails matched. This can be much more than the maximum that can be returned (20)! This number indicates the total number of new emails in the database. (If you want to get the emails after the first 20, then make another call with the get_older_list function</span></li></ol><ol class="c25" start="1"><li class="c22 c2"><span class="c0">&lsquo;email&rsquo; - The email address which the list is for. Eg. </span><span class="c18"><a href="mailto:test@guerrillamailblock.com">test@guerrillamailblock.com</a></span><span class="c0"> The client would need to watch this variable to detect any changes to sync the address.</span></li><li class="c22 c2"><span class="c0">&lsquo;ts&rsquo; - The timestamp of the email address, time of when the email address was created. The client can use this variable to sync the time. Emails expire after 60 minutes</span></li><li class="c22 c2"><span class="c0">&lsquo;s_active&rsquo; - Subscription active, Y or N</span></li><li class="c2 c22"><span class="c0">&lsquo;s_date&rsquo; - The full date of the subscription</span></li><li class="c22 c2"><span class="c0">&lsquo;s_time&rsquo; - The UNIX timestamp of subscription</span></li><li class="c22 c2"><span class="c0">&lsquo;s_time_expires&rsquo; - The UNIX timestamp for when the subscription expires</span></li></ol><p class="c2 c8"><span class="c0"></span></p><h5 class="c14 c2"><a name="h.w4ym8xjo6cqf"></a><span class="c0 c13">Function</span></h5><p class="c2 c8"><span class="c0"></span></p><p class="c2"><span class="c0 c4">get_email_list</span></p><p class="c2 c8"><span class="c0"></span></p><h5 class="c1"><a name="h.skoiftd7zwm0"></a><span class="c0 c13">Arguments</span></h5><p class="c2 c8"><span class="c0"></span></p><ol class="c9" start="1"><li class="c3 c2"><span class="c0">&lsquo;offset&rsquo; - How many emails to start from (skip). Starts from 0</span></li></ol><p class="c2 c8"><span class="c0"></span></p><ol class="c9" start="1"><li class="c3 c2"><span class="c0">&lsquo;seq&rsquo; - The sequence number(id) of the first email, optional</span></li></ol><p class="c2 c8"><span class="c0"></span></p><h5 class="c1"><a name="h.fmp6nwy0ck1y"></a><span class="c0 c13">Description</span></h5><p class="c2 c8"><span class="c0"></span></p><p class="c6 c2"><span class="c0">Gets a maximum of 20 messages from the specified offset. Offset of 0 will fetch a list of the first 10 emails, offset of 10 will fetch a list of the next 10, and so on. </span></p><p class="c5 c2"><span class="c0"></span></p><p class="c6 c2"><span class="c0">This function is useful for populating the initial email list. </span><span class="c0 c17">Note: When returned, subject and email excerpt are escaped using HTML Entities.</span></p><p class="c2 c8"><span class="c0"></span></p><h5 class="c1"><a name="h.5ykaczrag91w"></a><span class="c0 c13">Returns</span></h5><p class="c6 c2"><span class="c0">Identical to </span><span class="c0 c4">check_email</span><span class="c0"> described above</span></p><p class="c2 c8"><span class="c0"></span></p><p class="c2 c8"><span class="c0"></span></p><h5 class="c14 c2"><a name="h.rjqizyuoa60q"></a><span class="c0 c13">Function</span></h5><p class="c2 c8"><span class="c0"></span></p><p class="c2"><span class="c0 c4">fetch_email</span></p><p class="c2 c8"><span class="c0"></span></p><h5 class="c1"><a name="h.j55tfiiy48iu"></a><span class="c0 c13">Arguments</span></h5><p class="c2 c8"><span class="c0"></span></p><ol class="c9" start="1"><li class="c3 c2"><span class="c0">email_id - The id of the email to fetch</span></li></ol><p class="c2 c8"><span class="c0"></span></p><h5 class="c1"><a name="h.ue61h5j7r6bc"></a><span class="c0 c13">Description</span></h5><p class="c2 c8"><span class="c0"></span></p><p class="c6 c2"><span class="c0">Get the contents of an email. </span></p><p class="c5 c2"><span class="c0"></span></p><p class="c6 c2"><span class="c0">Notes: </span></p><p class="c6 c2"><span class="c0">- All HTML in the body of the email is filtered. Eg, Javascript, applets, iframes, etc is removed.</span></p><p class="c6 c2"><span class="c0">- All images in the email are relative to </span><span class="c18"><a href="http://www.guerrillamail.com/res.php">http://www.guerrillamail.com/res.php</a></span><span class="c0"> - this script will generate a &lsquo;blocked by GM&rsquo; image, indicating that the image was blocked. The CGI parameters for this script are as follows:</span></p><p class="c6 c2"><span class="c0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c0 c13">r</span><span class="c0"> = Is it a resource? 1 if true. Always 1</span></p><p class="c6 c2"><span class="c0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c0 c13">n</span><span class="c0">= Node. The element type. Can be a string of letters (a-z)</span></p><p class="c6 c2"><span class="c0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="c0 c13">q</span><span class="c0">= The query string for the original image. This is URL Encoded</span></p><p class="c6 c2"><span class="c0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Example URL: </span><span class="c18"><a href="http://www.guerrillamail.com/res.php?r=1&amp;n=img&amp;q=http%3A%2F%2Fstatic.groupon.de%2Fnewsletter_ums%2Flogo_groupon_de_DE.gif">http://www.guerrillamail.com/res.php?</a></span><span class="c18 c13"><a href="http://www.guerrillamail.com/res.php?r=1&amp;n=img&amp;q=http%3A%2F%2Fstatic.groupon.de%2Fnewsletter_ums%2Flogo_groupon_de_DE.gif">r</a></span><span class="c18"><a href="http://www.guerrillamail.com/res.php?r=1&amp;n=img&amp;q=http%3A%2F%2Fstatic.groupon.de%2Fnewsletter_ums%2Flogo_groupon_de_DE.gif">=1&amp;</a></span><span class="c18 c13"><a href="http://www.guerrillamail.com/res.php?r=1&amp;n=img&amp;q=http%3A%2F%2Fstatic.groupon.de%2Fnewsletter_ums%2Flogo_groupon_de_DE.gif">n</a></span><span class="c18"><a href="http://www.guerrillamail.com/res.php?r=1&amp;n=img&amp;q=http%3A%2F%2Fstatic.groupon.de%2Fnewsletter_ums%2Flogo_groupon_de_DE.gif">=img&amp;</a></span><span class="c13 c18"><a href="http://www.guerrillamail.com/res.php?r=1&amp;n=img&amp;q=http%3A%2F%2Fstatic.groupon.de%2Fnewsletter_ums%2Flogo_groupon_de_DE.gif">q</a></span><span class="c18"><a href="http://www.guerrillamail.com/res.php?r=1&amp;n=img&amp;q=http%3A%2F%2Fstatic.groupon.de%2Fnewsletter_ums%2Flogo_groupon_de_DE.gif">=http%3A%2F%2Fstatic.groupon.de%2Fnewsletter_ums%2Flogo_groupon_de_DE.gif</a></span></p><p class="c6 c2"><span class="c0">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;When an email is displayed by the client, it should displayed the blocked images generated by res.php. When a &lsquo;Display Images&rsquo; button is clicked, the client should use a regular expression to replace the links to res.php with the links to the image found in the &lsquo;</span><span class="c0 c13">q</span><span class="c0">&rsquo; parameter. Here is an example of this regular expression in the Javascript client:</span></p><p class="c2 c8"><span class="c0"></span></p><p class="c2"><span class="c7">// Javascript example: This will replace all the res.php links inside double quotes with the URL stored in the q parameter. Since the URL in the q parameter is URL Escaped, we need to define an anonymous function to unescape the matched parameter. The &lsquo;g&rsquo; flag tells the regex engine to replace all occurrences in the string.</span></p><p class="c2 c8"><span class="c0"></span></p><p class="c2"><span class="c7">temp_html = temp_html.replace(/&quot;\/res\.php\?r=1&amp;amp;n=[a-z]+&amp;amp;q=([^&quot;^&amp;]+)&quot;/g, function(str, p1, offset, s) {return unescape (p1); } );</span></p><p class="c2"><span class="c7"> &nbsp; &nbsp; &nbsp; // Sometimes the link can be enclosed inside html encoded quotes, &amp;quot;</span></p><p class="c2"><span class="c7">temp_html = temp_html.replace(/&amp;quot;\/res\.php\?r=1&amp;amp;n=[a-z]+&amp;amp;q=([^&quot;]+)&amp;quot;/g, function(str, p1, offset, s) {return &quot;&amp;quot;&quot;+unescape(p1)+&quot;&amp;quot;&quot; ; } ); </span></p><p class="c2 c11 c8"><span class="c7"></span></p><p class="c2 c11"><span class="c0">Here is the above example written as PHP code (using the &lsquo;e&rsquo; modifier allows us to call the urldecode function on the matched parameter):</span></p><p class="c2 c11 c8"><span class="c0"></span></p><p class="c2"><span class="c7">$source = preg_replace (&#39;#&quot;/res\.php\?r=1&amp;amp;n=img&amp;amp;q=([^&quot;]+)&quot;#e&#39;, &quot;urldecode(&#39;\\1&#39;)&quot;, $source);</span></p><p class="c2 c11 c8"><span class="c7"></span></p><p class="c2"><span class="c7">$source = preg_replace (&#39;#&amp;quot;/res\.php\?r=1&amp;amp;n=img&amp;amp;q=([^&quot;]+)&amp;quot;#e&#39;, &quot;urldecode(&#39;\\1&#39;)&quot;, $source);</span></p><p class="c2 c11 c8"><span class="c0"></span></p><p class="c2 c11 c8"><span class="c0"></span></p><p class="c6 c2"><span class="c0">- Subject and email excerpt are escaped using HTML Entities.</span></p><p class="c6 c2"><span class="c0">- Only emails owned by the current session id can be fetched.</span></p><p class="c2 c8"><span class="c0"></span></p><h5 class="c14 c2"><a name="h.krvhwfsd9hz"></a><span class="c0 c13">Function</span></h5><p class="c2"><span class="c0 c4">forget_me</span></p><h5 class="c1"><a name="h.t6feny1veq94"></a><span class="c0 c13">Arguments</span></h5><ol class="c9" start="1"><li class="c3 c2"><span class="c0">email_addr</span></li></ol><h5 class="c1"><a name="h.doij7410ibpo"></a><span class="c0 c13">Description</span></h5><p class="c6 c2"><span class="c0">Forget the current email address. This will not stop the session, the existing session will be maintained. A subsequent call to </span><span class="c0 c4">get_email_address</span><span class="c0"> will fetch a new email address or the client can call </span><span class="c0 c4">set_email_user</span><span class="c0"> to set a new address. Typically, a user would want to set a new address manually after clicking the &lsquo;forget me&rsquo; button.</span></p><p class="c2 c8"><span class="c0"></span></p><h5 class="c1"><a name="h.g9wf0dazk3py"></a><span class="c0 c13">Returns</span></h5><p class="c6 c2"><span class="c0">True if successful. Note that the SUBSCR cookie will be deleted after making this call, however, PHPSESSID will persist.</span></p><p class="c2 c11 c8"><span class="c0"></span></p><p class="c2 c8"><span class="c0"></span></p><p class="c2 c8"><span class="c0"></span></p><h5 class="c14 c2"><a name="h.gxitoeubj26s"></a><span class="c0 c13">Function </span></h5><p class="c2"><span class="c0 c4">del_email</span></p><h5 class="c1"><a name="h.xe98r6vtvpr5"></a><span class="c0 c13">Arguments</span></h5><ol class="c9" start="1"><li class="c3 c2"><span class="c0">email_ids - array or an integer, in the following format: email_ids[]=425&amp;email_ids[]=426&amp;email_ids[]=427<br><br>Where 425, 426 and 427 are the ids of emails to delete. In a HTTP request, this parameter would be encoded like this:</span></li></ol><p class="c6 c2"><span class="c0">email_ids%5B%5D=425&amp;email_ids%5B%5D=426&amp;email_ids%5B%5D=427</span></p><p class="c5 c2"><span class="c0"></span></p><p class="c6 c2"><span class="c0">(See example PHP code below for how the $req string is generated. Another example here </span><span class="c18"><a href="http://snipplr.com/view/4444/passing-an-array-through-get-request/">http://snipplr.com/view/4444/passing-an-array-through-get-request/</a></span><span class="c0">)</span></p><p class="c5 c2"><span class="c0"></span></p><h5 class="c1"><a name="h.9wx4en2wdgz0"></a><span class="c0 c13">Description</span></h5><p class="c6 c2"><span class="c0">Delete the emails from the server</span></p><p class="c5 c2"><span class="c0"></span></p><h5 class="c14 c2"><a name="h.63c9efxk3lwb"></a><span class="c0 c13">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns</span></h5><p class="c6 c2"><span class="c0">An array of deleted email ids</span></p><p class="c2 c8"><span class="c0"></span></p><p class="c2 c8"><span class="c0"></span></p><h5 class="c14 c2"><a name="h.exibu6hjbfjw"></a><span class="c0 c13">Function </span></h5><p class="c2"><span class="c0 c4">extend</span></p><p class="c2 c8"><span class="c0"></span></p><h5 class="c1"><a name="h.uqkon1shhgtz"></a><span class="c0 c13">Arguments</span></h5><ol class="c9" start="1"><li class="c3 c2"><span class="c0">(none)</span></li></ol><p class="c2 c8"><span class="c0"></span></p><h5 class="c1"><a name="h.crcgfc4bua67"></a><span class="c0 c13">Description</span></h5><h5 class="c14 c6 c2"><a name="h.dgg274fcnbhd"></a><span class="c0">Extend the email address time by 1 hour. A maximum of 2 hours can be extended.</span></h5><h5 class="c1"><a name="h.mve6qtpdt3jk"></a><span class="c0 c13">Returns</span></h5><p class="c2 c11"><span class="c0">An object with the following properties:</span></p><p class="c2 c11 c8"><span class="c0"></span></p><p class="c2 c11"><span class="c0">&lsquo;expired&rsquo; - true or false, indicating if the email has expired</span></p><p class="c2 c11"><span class="c0">&lsquo;email_timestamp&rsquo; - A UNIX timestamp indicating the time of when the address was created. Can be in the future.</span></p><p class="c2 c11"><span class="c0">&lsquo;affected&rsquo; - 1 if extended successfully, 0 if not successful</span></p><p class="c2 c11 c8"><span class="c0"></span></p><p class="c2 c11 c8"><span class="c0"></span></p><h3 class="c16 c2"><a name="h.d3a7g9hkrves"></a><span class="c13 c19">Sample client code (PHP):</span></h3><p class="c2 c8"><span class="c0"></span></p><p class="c2"><span class="c0">The following sample code shows how to interact with the API using PHP:</span></p><p class="c2 c8"><span class="c0"></span></p><p class="c2 c8"><span class="c0"></span></p><p class="c2 c8"><span class="c0"></span></p><p class="c2 c8"><span class="c7"></span></p><p class="c2"><span class="c7">require(&#39;JSON.php&#39;); // grab your copy from </span><span class="c21"><a href="http://mike.teczno.com/json.html">http://mike.teczno.com/json.html</a></span><span class="c7"> or change the code to use the JSON PHP extension if you have it enabled.</span></p><p class="c2 c8"><span class="c7"></span></p><p class="c2"><span class="c7">function api_call($function, $params, $req_type=&#39;POST&#39;, $decode=true) {</span></p><p class="c2 c8"><span class="c7"></span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$params[&#39;ip&#39;] = $_SERVER[&#39;REMOTE_ADDR&#39;];</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$params[&#39;agent&#39;] = substr($_SERVER[&#39;HTTP_USER_AGENT&#39;], 0, 160); </span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$result = null;</span></p><p class="c2"><span class="c7"> &nbsp; &nbsp;</span></p><p class="c2"><span class="c7"> &nbsp; </span></p><p class="c2"><span class="c7"> &nbsp; &nbsp;</span></p><p class="c2"><span class="c7"> &nbsp; &nbsp;if (isset($_COOKIE[&#39;SUBSCR&#39;])) {</span></p><p class="c2"><span class="c7"> &nbsp; &nbsp; &nbsp; &nbsp;$toks = explode(&#39;:&#39;, $_REQUEST[&#39;SUBSCR&#39;]);</span></p><p class="c2"><span class="c7"> &nbsp; &nbsp; &nbsp; &nbsp;$hash = array_shift($toks);</span></p><p class="c2"><span class="c7"> &nbsp; &nbsp; &nbsp; &nbsp;$email_addr = array_shift($toks);</span></p><p class="c2"><span class="c7"> &nbsp; &nbsp; &nbsp; &nbsp;$email_timestamp = array_shift($toks);</span></p><p class="c2"><span class="c7"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></p><p class="c2"><span class="c7"> &nbsp; &nbsp; &nbsp; &nbsp;$params[&#39;SUBSCR&#39;] = $_COOKIE[&#39;SUBSCR&#39;];</span></p><p class="c2"><span class="c7"> &nbsp; &nbsp; &nbsp; &nbsp;</span></p><p class="c2"><span class="c7"> &nbsp; &nbsp;}</span></p><p class="c2 c8"><span class="c7"></span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$req = &#39;f=&#39;.$function;</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach ($params as $key =&gt; $val) {</span></p><p class="c2"><span class="c7"> &nbsp; &nbsp; &nbsp; &nbsp;if (is_array($val)) {</span></p><p class="c2"><span class="c7"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;foreach ($val as $ak =&gt; $av) {</span></p><p class="c2"><span class="c7"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;$req .= &#39;&amp;&#39;.$key.&#39;%5B%5D=&#39;.urlencode($av);</span></p><p class="c2"><span class="c7"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c2"><span class="c7"> &nbsp; &nbsp; &nbsp; &nbsp;} else {</span></p><p class="c2"><span class="c7"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;$req .= &#39;&amp;&#39;.$key.&#39;=&#39;.urlencode($val);</span></p><p class="c2"><span class="c7"> &nbsp; &nbsp; &nbsp; &nbsp;}</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p class="c2"><span class="c7"> &nbsp; &nbsp;</span></p><p class="c2 c8"><span class="c7"></span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$host = &#39;www.guerrillamail.com&#39;;</span></p><p class="c2"><span class="c7"> &nbsp; &nbsp;</span></p><p class="c2"><span class="c7"> &nbsp; &nbsp;if (strpos(__FILE__, &#39;/dev&#39;)!==false) {</span></p><p class="c2"><span class="c7"> &nbsp; &nbsp; &nbsp; &nbsp;$resource = &#39;/dev/ajax.php&#39;;</span></p><p class="c2"><span class="c7"> &nbsp; &nbsp;} else {</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; $resource = &#39;/ajax.php&#39;;</span></p><p class="c2"><span class="c7"> &nbsp; &nbsp;}</span></p><p class="c2 c8"><span class="c7"></span></p><p class="c2"><span class="c7">//echo &#39;&lt;A href=&quot;http://&#39;.$host.$resource.&#39;?&#39;.htmlentities($req).&#39;&quot;&gt;&#39;.htmlentities($host.$resource).&#39;?&#39;.htmlentities($req).&#39;&lt;/a&gt;&#39;;</span></p><p class="c2 c8"><span class="c7"></span></p><p class="c2 c8"><span class="c7"></span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$fp = fsockopen ($host, 80, $errno, $errstr, 10);</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($fp) {</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p class="c2 c8"><span class="c7"></span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($req_type==&#39;GET&#39;) {</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$get = $resource.&#39;?&#39;.$req;</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$send &nbsp;= &quot;GET $get HTTP/1.0\r\n&quot;; // dont need chunked so use HTTP/1.0</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$send .= &quot;Host: $host\r\n&quot;;</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$send .= &quot;User-Agent: Guerrilla Mail API (www.guerrillamail.com)\r\n&quot;;</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$send .= &quot;Referer: &quot;.$_SERVER[&#39;SERVER_NAME&#39;].&quot;\r\n&quot;;</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (isset($_SESSION[&#39;API_SESSION&#39;])) {</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//$send .= &quot;Cookie: PHPSESSID=&quot;.$_SESSION[&#39;API_SESSION&#39;].&quot;\r\n&quot;;</span></p><p class="c2"><span class="c7"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p class="c2"><span class="c7"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;$send .= &quot;Cookie: PHPSESSID=&quot;.session_id().&quot;\r\n&quot;;</span></p><p class="c2"><span class="c7"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$send .= &quot;Content-Type: text/xml\r\n&quot;;</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$send .= &quot;Connection: Close\r\n\r\n&quot;; </span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Post the data</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$send = &quot;POST &quot;.$resource.&quot; HTTP/1.0\r\n&quot;;</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$send .= &quot;Host: $host\r\n&quot;;</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$send .= &quot;User-Agent: Guerrilla Mail API (www.guerrillamail.com)\r\n&quot;;</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$send .= &quot;Referer: &quot;.$_SERVER[&#39;SERVER_NAME&#39;].&quot;\r\n&quot;;</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (isset($_SESSION[&#39;API_SESSION&#39;])) {</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//$send .= &quot;Cookie: PHPSESSID=&quot;.$_SESSION[&#39;API_SESSION&#39;].&quot;\r\n&quot;;</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p class="c2"><span class="c7"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;$send .= &quot;Cookie: PHPSESSID=&quot;.session_id().&quot;\r\n&quot;;</span></p><p class="c2"><span class="c7"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$send .= &quot;Content-Type: application/x-www-form-urlencoded\r\n&quot;;</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$send .= &quot;Content-Length: &quot; . strlen($req) . &quot;\r\n\r\n&quot;;</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$send .= $req; // post the request</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p class="c2"><span class="c7"> &nbsp; &nbsp; &nbsp; &nbsp;</span></p><p class="c2"><span class="c7"> &nbsp; &nbsp; &nbsp; &nbsp;//echo $send;</span></p><p class="c2 c8"><span class="c7"></span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($sent = fputs ($fp, $send, strlen($send))) &nbsp;{ &nbsp;// do the request</span></p><p class="c2 c8"><span class="c7"></span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// skip headers... parse cookies</span></p><p class="c2 c8"><span class="c7"></span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while (!feof($fp)) { // skip the header</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$res = fgets ($fp);</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (preg_match (&#39;#Set-Cookie: PHPSESSID=(.+?);#&#39;, $res, $m)) {</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// extracted the PHP session ID</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// so that we can maintain a session between the client/server</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$_SESSION[&#39;API_SESSION&#39;] = $m[1]; </span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p class="c2"><span class="c7"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></p><p class="c2"><span class="c7"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;// grab the SUBSCR cookie from the reply and set to the client</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (preg_match (&#39;#Set-Cookie: (SUBSCR=.+)#&#39;, $res, $m)) {</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$data = explode(&#39;;&#39;, $m[1]);</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach ($data as $item) {</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$pair = explode(&#39;=&#39;, $item);</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (trim($pair[0])==&#39;expires&#39;) {</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// needs to be in a unix timestamp</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$cookie[trim($pair[0])] = strtotime(trim(urldecode($pair[1])));</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$cookie[trim($pair[0])] = trim(urldecode($pair[1]));</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p class="c2 c8"><span class="c7"></span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($_SERVER[&#39;HTTP_HOST&#39;]==&#39;localhost&#39;) {</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$host = $_SERVER[&#39;HTTP_HOST&#39;];</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$host = &#39;.&#39;.str_replace(&#39;.www&#39;, &#39;&#39;, $_SERVER[&#39;HTTP_HOST&#39;]);</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (setcookie(&#39;SUBSCR&#39;, $cookie[&#39;SUBSCR&#39;], $cookie[&#39;expires&#39;], &#39;/&#39;, $host)) { // , $host</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//echo &#39;cookie set&#39;;</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p class="c2 c8"><span class="c7"></span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p class="c2 c8"><span class="c7"></span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p class="c2 c8"><span class="c7"></span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (strcmp($res, &quot;\r\n&quot;)===0) break;</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p class="c2 c8"><span class="c7"></span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$buffer = &#39;&#39;;</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($sent) { &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p class="c2 c8"><span class="c7"></span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while(!feof($fp)) {</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$buffer .= fread($fp, 1024);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$JSON = new Services_JSON();</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($decode) {</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$result = $JSON-&gt;decode($buffer);</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$result = $buffer;</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p class="c2 c8"><span class="c7"></span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($fp) {</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fclose($fp);</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p class="c2 c8"><span class="c7"></span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $result;</span></p><p class="c2 c8"><span class="c7"></span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {</span></p><p class="c2 c8"><span class="c7"></span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return null;</span></p><p class="c2"><span class="c7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</span></p><p class="c2 c8"><span class="c7"></span></p><p class="c2 c8"><span class="c7"></span></p><p class="c2"><span class="c7">}</span></p><p class="c2 c8"><span class="c7"></span></p><p class="c2 c8"><span class="c0"></span></p><p class="c2 c8"><span class="c0"></span></p><p class="c2 c8"><span class="c0"></span></p></body></html>
